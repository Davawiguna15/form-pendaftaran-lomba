<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Pendaftaran Lomba 17 Agustus 2025</title>
  <style>
    body { font-family: sans-serif; text-align: center; background: #f4f4f4; margin: 0; padding: 0; }
    .container { max-width: 500px; margin: 40px auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px #aaa; }
    h1, h2 { margin-bottom: 20px; }
    label { text-align: left; display: block; margin: 10px 0 5px; }
    input, select, button { width: 100%; padding: 10px; margin-bottom: 15px; }
    button { background: #007bff; color: white; border: none; cursor: pointer; }
    button:hover { background: #0056b3; }
    .hidden { display: none; }
  </style>
</head>
<body>

<div id="home" class="container">
  <h1>Haii Peserta Lomba 17 Agustus 2025 RT04/RW14</h1>
  <button onclick="showForm()">Klik Start untuk Memulai</button>
</div>

<div id="formSection" class="container hidden">
  <h2>Formulir Pendaftaran</h2>
  <form id="lombaForm">
    <label>Nama Lengkap:</label>
    <input type="text" name="nama" required>

    <label>Usia:</label>
    <input type="number" name="usia" id="usia" min="3" max="99" required onchange="updateLombaOptions()">

    <label>Nomor HP Orang Tua / Peserta:</label>
    <input type="tel" name="nomor_hp" required>

    <label>Dari Buni Berapa:</label>
    <select name="buni" required>
      <option value="">Pilih Buni</option>
      <option>Buni Raya</option>
      <option>Buni 1</option>
      <option>Buni 2</option>
      <option>Buni 3</option>
      <option>Buni 4</option>
      <option>Buni 5</option>
    </select>

    <div id="lombaContainer" class="hidden">
      <label>Pilih Lomba (Maksimal 2):</label>
      <select id="lomba" name="lomba" multiple size="4" required></select>
    </div>

    <button type="submit">Kirim Pendaftaran</button>
  </form>
</div>

<div id="thanks" class="container hidden">
  <h2>Terimakasih telah mendaftar!</h2>
  <p>KAMI TUNGGU KEDATANGAN KALIAN</p>
  <strong>SEE YOUU!</strong>
</div>

<script>
  const usiaLombaMap = {
    "3-5": ["Mewarnai", "Masukin Bendera", "Estafet gundu"],
    "6-8": ["Menyusun Puzzle", "Masukin Bendera", "Estafet gundu"],
    "9-11": ["Meniup Gelas", "Masukin Bendera", "Estafet gundu"],
    "11-13": ["Memindahkan kacang dengan sumpit", "Masukin Bendera", "Estafet gundu"],
    "ibu": ["Estafet Air", "Masukin Bendera", "Estafet gundu"],
    "bapak": ["Estafet getok palu", "Masukin Bendera", "Estafet gundu"]
  };

  function showForm() {
    document.getElementById('home').classList.add('hidden');
    document.getElementById('formSection').classList.remove('hidden');
  }

  function updateLombaOptions() {
    const usia = parseInt(document.getElementById('usia').value);
    const select = document.getElementById('lomba');
    const container = document.getElementById('lombaContainer');
    select.innerHTML = "";
    let options = [];

    if (usia >= 3 && usia <= 5) options = usiaLombaMap["3-5"];
    else if (usia >= 6 && usia <= 8) options = usiaLombaMap["6-8"];
    else if (usia >= 9 && usia <= 11) options = usiaLombaMap["9-11"];
    else if (usia >= 12 && usia <= 13) options = usiaLombaMap["11-13"];
    else if (usia >= 20 && usia <= 60) options = usiaLombaMap["bapak"]; // dewasa
    else if (usia >= 18 && usia <= 60) options = usiaLombaMap["ibu"]; // ibu

    if (options.length > 0) {
      container.classList.remove("hidden");
      options.forEach(opt => {
        const el = document.createElement("option");
        el.value = opt;
        el.textContent = opt;
        select.appendChild(el);
      });
    } else {
      container.classList.add("hidden");
    }
  }

  document.getElementById("lombaForm").addEventListener("submit", async function(e) {
    e.preventDefault();
    const form = e.target;
    const selectedLomba = [...form.lomba.options].filter(o => o.selected).map(o => o.value);
    if (selectedLomba.length === 0 || selectedLomba.length > 2) {
      alert("Pilih maksimal 2 lomba.");
      return;
    }

    const data = {
      nama: form.nama.value,
      usia: form.usia.value,
      nomor_hp: form.nomor_hp.value,
      buni: form.buni.value,
      lomba: selectedLomba.join(", ")
    };

    try {
      await fetch("https://script.google.com/macros/s/AKfycbyxsTSPmavgBQXb8nJE0sDRkeiaxpbeqb1KiW2-Hdh9urjYFXuN8qRCI8WYkn5uVgd87A/exec", {
        method: "POST",
        body: JSON.stringify(data),
        headers: { "Content-Type": "application/json" }
      });
      form.reset();
      document.getElementById("formSection").classList.add("hidden");
      document.getElementById("thanks").classList.remove("hidden");
    } catch (err) {
      alert("Terjadi kesalahan saat mengirim data.");
    }
  });
</script>
</body>
</html>
